let processEvents=SecurityEvent
                        | where EventID==4688
                        | project  TimeGenerated, ComputerName=Computer,AccountName=SubjectUserName, AccountDomain=SubjectDomainName, FileName=split(NewProcessName, @'')[(-1)], ProcessCommandLine = CommandLine, InitiatingProcessFileName=ParentProcessName,InitiatingProcessCommandLine='',InitiatingProcessParentFileName=''
                        | where TimeGenerated >= ago(30d); 
                    processEvents
                    | where TimeGenerated < ago(1d)
                    | summarize HostCount=dcount(ComputerName) by tostring(FileName)
                    | join kind=rightanti
                    (
                        processEvents
                        | where TimeGenerated >= ago(1d)
                        | summarize HostCount=dcount(ComputerName) by tostring(FileName)
                    )
                    on FileName
                    | project HostCount, FileName